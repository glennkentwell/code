Most of this code isn't mine!

Just so you know...
